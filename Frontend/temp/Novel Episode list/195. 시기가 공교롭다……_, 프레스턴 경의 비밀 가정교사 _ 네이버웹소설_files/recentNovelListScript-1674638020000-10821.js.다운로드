var RecentNovel=jindo.$Class({_LOCAL_STORAGE_NAME:"recentNovel",_COOKIE_NAME:"novel_rp",_MAX_NOVEL_COUNT:50,$init:function(){this._oLocalStorage=new LocalStorageUtil();},add:function(a,b,c){if(c==null){c=0;}this._addToCookie(a,b,c);return this._addToLocalStorage(a,b,c);},_addToCookie:function(j,h,a){if(a==null){a=0;}var g=jindo.$Cookie().get(this._COOKIE_NAME)||"";if(!g){g=j+"_"+h+"_"+a;jindo.$Cookie().set(this._COOKIE_NAME,g,365,location.host);return;}var e=g.split(",");for(var c=0,b=e.length;c<b;c++){var f=e[c].split("_");if(f[0]==j){e.splice(c,1);break;}}var d=(j+"_"+h+"_"+a);e=[d].concat(e);e.splice(this._MAX_NOVEL_COUNT,1);jindo.$Cookie().set(this._COOKIE_NAME,e.join(","),365,location.host);},_addToLocalStorage:function(k,j,a){if(a==null){a=0;}var d=this._oLocalStorage.get(this._LOCAL_STORAGE_NAME);var h=jindo.$Json(d);var n=h.toObject();var g=new Array();if(n){for(var f=0,c=n.length;f<c;f++){var e=n[f];if(e.novelId!=k){g=g.concat(e);}}}var o=jindo.$Date();var b={novelId:k,volumeNo:j,scrollPosition:a,date:o.format("YmdHis")};var m=[b];m=m.concat(g);m.splice(this._MAX_NOVEL_COUNT,1);this._oLocalStorage.set(this._LOCAL_STORAGE_NAME,m);return m;},_restoreToLocalStorage:function(m,k,a,h){if(a==null){a=0;}if(h==null){var p=jindo.$Date();h=p.format("YmdHis");}var d=this._oLocalStorage.get(this._LOCAL_STORAGE_NAME);var j=jindo.$Json(d);var o=j.toObject();var g=new Array();if(o){for(var f=0,c=o.length;f<c;f++){var e=o[f];if(e.novelId!=m){g=g.concat(e);}}}var b={novelId:m,volumeNo:k,scrollPosition:a,date:h};var n=[b];n=n.concat(g);n.splice(this._MAX_NOVEL_COUNT,1);this._oLocalStorage.set(this._LOCAL_STORAGE_NAME,n);return n;},get:function(k){var h=this._oLocalStorage.get(this._LOCAL_STORAGE_NAME);var d=false;try{var g=jindo.$Json(h);var m=g.toObject();if(m.length==0){d=true;}}catch(f){d=true;}if(typeof m!="object"||d){m=this.getFromCookie();this._oLocalStorage.set(this._LOCAL_STORAGE_NAME,m);}if(!m||typeof m!="object"){return null;}var j=[];for(var c=m.length-1;c>=0;c--){var b=m[c];if(typeof b.novelId=="undefined"){m.splice(c,1);this._oLocalStorage.set(this._LOCAL_STORAGE_NAME,m);}else{j.push(b);}}j.reverse();if(!k){return j;}for(var c=0,a=j.length;c<a;c++){var b=j[c];if(b.novelId==k){return j[c];}}return null;},getFromCookie:function(c){var b=jindo.$Cookie().get(this._COOKIE_NAME)||"";if(!b){return[];}var e=b.split(",");var f=[];if(e&&e.length>0){for(var d=0,a=e.length;d<a;d++){var g=e[d].split("_");if(g[2]!=null){f.push({novelId:g[0],volumeNo:g[1],scrollPosition:g[2]});}else{f.push({novelId:g[0],volumeNo:g[1],scrollPosition:0});}}}if(!c){return f;}for(var d=0,a=f.length;d<a;d++){if(f[d]["novelId"]==c){return f[d];}}return[];},remove:function(a){this._removeFromCookie(a);return this._removeFromLocalStorage(a);},_removeFromCookie:function(b){if(!b){jindo.$Cookie().remove(this._COOKIE_NAME,location.host);return;}var f=jindo.$Cookie().get(this._COOKIE_NAME)||"";if(!f){return;}var d=f.split(",");for(var c=0,a=d.length;c<a;c++){var e=d[c].split("_");if(e[0]==b){d.splice(c,1);break;}}jindo.$Cookie().set(this._COOKIE_NAME,d.join(","),365,location.host);},_removeFromLocalStorage:function(b){if(!b){this._oLocalStorage.remove(this._LOCAL_STORAGE_NAME);return;}var c=this._oLocalStorage.get(this._LOCAL_STORAGE_NAME);var f=jindo.$Json(c);var g=f.toObject();if(g){for(var d=0,a=g.length;d<a;d++){var e=g[d];if(e.novelId==b){g.splice(d,1);break;}}}this._oLocalStorage.set(this._LOCAL_STORAGE_NAME,g);return g;}});